import{c as ee,_ as ae}from"./index.928e1f3b.js";/* empty css              *//* empty css               */import{E as ue}from"./index.3ff52e9e.js";/* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as oe,e as C,r as te,z as le,C as V,D as U,G as p,aI as u,aH as s,u as m,aK as se,aJ as de,aE as ne,aN as b,aO as re,bk as S,aR as f,b1 as ie,b2 as ce,bg as me,bw as fe,bx as pe,bM as _e,bc as Fe,br as Ce,bs as ge,by as Be,be as Ee,b8 as De,aW as be,b9 as he,ba as ve}from"./arco.b2fea22a.js";import{u as Ae}from"./loading.41f62eb6.js";import{f as we}from"./vue.e5338f86.js";import{e as ye,c as Ve,f as xe,m as Ne}from"./studentmgmt.217d652b.js";import{g as Re}from"./classmgmt.1aeaeb2c.js";import{a as Ue}from"./tools.c661ac2d.js";import{r as g}from"./index.614842bb.js";import"./chart.2195b2ce.js";/* empty css               */import"./file-handle.b0154fd5.js";const Se={nations:"/oapi/dict/list"},ke=F=>ee({method:"get",url:Se.nations,params:F}),k=F=>(he("data-v-a9daee1f"),F=F(),ve(),F),Ie={class:"container"},qe={class:"custom-form-wrap"},Te={class:"right-part"},Le={class:"item-top-class"},Pe={class:"e-uploader-class"},Ge=k(()=>p("div",{class:"normal-tips"},"\u62D6\u62FD\u4E0A\u4F20",-1)),He=k(()=>p("div",{class:"normal-tips"},"\u5B66\u751F\u7167\u7247",-1)),Me={class:"item-bottom-class"},Oe={class:"bottom-btns"},je=b(" \u4FDD\u5B58 "),ze=b("\u91CD\u7F6E"),$e=b("\u8FD4\u56DE"),Je=oe({__name:"add",setup(F){const B=we(),h=C(""),E=C(),x=C(null),v=C([]),A=C([]),{loading:I,setLoading:_}=Ae(),q=[{value:1,label:"\u5728\u6821"},{value:2,label:"\u5DF2\u8F6C\u6821"},{value:3,label:"\u5DF2\u5F00\u9664"},{value:4,label:"\u5DF2\u4F11\u5B66"},{value:5,label:"\u5DF2\u6BD5\u4E1A"}],T=[{value:1,label:"\u7537"},{value:2,label:"\u5973"}],a=te({name:"",sex:"",birthday:"",nationCode:"",nationName:"",identityCard:"",icCard:"",portrait:"",familyAddress:"",source:"",status:"",gradeCode:"",classesCode:"",userStudentNo:"",emergencyContactPhone:""}),L=o=>{a.portrait=o.badgeToken||""},P=async()=>{var l;const{succ:o,data:e,msg:d}=await Re();o?((l=e.sort((n,r)=>Number(n.gradeCode)-Number(r.gradeCode)))==null||l.forEach(n=>{n.label=n.gradeName,n.value=n.gradeCode}),v.value=e):f.error(d)},G=async()=>{const{succ:o,data:e,msg:d}=await ke({dictType:"nation"});o?A.value=e:f.error(d)},N=async(o,e)=>{const{succ:d,data:l,msg:n}=await Ve({gradeCode:o});d?((l==null?void 0:l.length)>0&&l.forEach(r=>{r.isLeaf=!0,r.label=r.classesName,r.value=r.classesCode}),e(l||[])):f.error(n)},H=o=>{o?a.classesCode=o:(a.gradeCode="",a.classesCode="")},M=o=>{var e;a.nationCode=o,a.nationName=(e=A.value.find(d=>d.dictCode===o))==null?void 0:e.dictName},O=async()=>{_(!0);const{succ:o,msg:e}=await xe(a);o?(f.success("\u65B0\u589E\u6210\u529F"),setTimeout(()=>{_(!1),B.replace({name:"Studentmgmt"})},500)):(_(!1),f.error(e))},j=async()=>{const{succ:o,msg:e}=await Ne({...a,id:h.value});o?(f.success("\u66F4\u65B0\u6210\u529F"),setTimeout(()=>{_(!1),B.replace({name:"Studentmgmt"})},500)):(_(!1),f.error(e))},z=(o,e)=>{const{gradeCode:d}=o;window.setTimeout(()=>{a.gradeCode=d,N(d,e)},600)},$=o=>{const{nationName:e,gradeCode:d,classesCode:l,portrait:n}=o,r=E.value;Object.keys(o).forEach(i=>{const c=o[i];r.setFields({[i]:{value:c}}),i==="emergencyContactPhone"&&r.setFields({[i]:{value:c||""}})}),a.nationName=e,a.gradeCode=d,a.classesCode=l,a.portrait=n;const D=i=>{v.value.some(c=>c.gradeCode===d?(c.children=i,!0):!1)},w=x.value;if(n){const i=Ue(n);w.setBackImg(i)}N(d,D)},J=async o=>{const{succ:e,data:d,msg:l}=await ye({id:o});e?($(d),console.log("\u56DE\u663E",a)):f.error(l)},K=()=>{E.value.resetFields()},W=()=>{B.back()},Q=()=>{_(!0),E.value.validate(e=>{e?_(!1):h.value?j():O()})};return le(async()=>{await P(),await G();const{query:{id:o}}=B.currentRoute.value;o&&(h.value=o,await J(o))}),(o,e)=>{const d=ie,l=ce,n=me,r=fe,D=pe,w=_e,i=Fe,c=Ce,R=ge,X=Be,Y=Ee,Z=De,y=be;return V(),U("div",Ie,[p("div",qe,[u(Z,{ref_key:"formRef",ref:E,model:a,class:"custom-form"},{default:s(()=>[p("div",Te,[p("div",Le,[u(R,{gutter:10},{default:s(()=>[u(c,{span:12},{default:s(()=>[u(l,{field:"name",label:"\u59D3\u540D",rules:[{required:!0,message:"\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A"},{match:m(g).chineseCharacter,message:"\u5B66\u751F\u59D3\u540D\u4E3A\u6C49\u5B57\u6216\u6C49\u5B57\u52A0\u7279\u6B8A\u7B26\u53F7"}]},{default:s(()=>[u(d,{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.name=t),placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",autocomplete:"off","allow-clear":"","max-length":15,"show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"]),u(l,{field:"sex",label:"\u6027\u522B",rules:[{required:!0,message:"\u6027\u522B\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:s(()=>[u(n,{modelValue:a.sex,"onUpdate:modelValue":e[1]||(e[1]=t=>a.sex=t),options:T},null,8,["modelValue"])]),_:1}),u(l,{field:"nationCode",label:"\u6C11\u65CF",rules:[{required:!0,message:"\u6C11\u65CF\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:s(()=>[u(D,{modelValue:a.nationCode,"onUpdate:modelValue":e[2]||(e[2]=t=>a.nationCode=t),placeholder:"\u8BF7\u9009\u62E9\u6C11\u65CF","allow-clear":"",onChange:M},{default:s(()=>[(V(!0),U(se,null,de(A.value,t=>(V(),ne(r,{key:t.dictId,value:t.dictCode},{default:s(()=>[b(re(t.dictName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(l,{field:"birthday",label:"\u51FA\u751F\u65E5\u671F",rules:[{required:!0,message:"\u51FA\u751F\u65E5\u671F\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:s(()=>[u(w,{modelValue:a.birthday,"onUpdate:modelValue":e[3]||(e[3]=t=>a.birthday=t),style:{width:"320px"},"allow-clear":"","disabled-date":t=>m(S)(t).isAfter(m(S)())},null,8,["modelValue","disabled-date"])]),_:1}),u(l,{field:"classesCode",label:"\u5E74\u7EA7/\u73ED\u522B",rules:[{required:!0,message:"\u5E74\u7EA7\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:s(()=>[u(i,{modelValue:a.classesCode,"onUpdate:modelValue":e[4]||(e[4]=t=>a.classesCode=t),options:v.value,"allow-clear":"",placeholder:"\u8BF7\u9009\u62E9...",style:{width:"320px"},"load-more":z,onChange:H},null,8,["modelValue","options"])]),_:1})]),_:1}),u(c,{span:12},{default:s(()=>[p("div",Pe,[u(l,{"hide-label":""},{default:s(()=>[u(ue,{ref_key:"uploaderRef",ref:x,onUpdateImgUrl:L},{"uploader-tips":s(()=>[Ge,He]),_:1},512)]),_:1})])]),_:1})]),_:1})]),u(X),p("div",Me,[u(R,{gutter:10},{default:s(()=>[u(c,{span:12},{default:s(()=>[u(l,{field:"source",label:"\u5B66\u751F\u6765\u6E90"},{default:s(()=>[u(d,{modelValue:a.source,"onUpdate:modelValue":e[5]||(e[5]=t=>a.source=t),placeholder:"\u8BF7\u8F93\u5165\u5B66\u751F\u6765\u6E90",autocomplete:"off","allow-clear":"","max-length":20,"show-word-limit":""},null,8,["modelValue"])]),_:1}),u(l,{field:"userStudentNo",label:"\u5B66\u7C4D\u53F7",rules:[{required:!0,match:m(g).normal,message:"\u5B66\u7C4D\u53F7\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:s(()=>[u(d,{modelValue:a.userStudentNo,"onUpdate:modelValue":e[6]||(e[6]=t=>a.userStudentNo=t),placeholder:"\u8BF7\u8F93\u5165\u5B66\u7C4D\u53F7",autocomplete:"off","allow-clear":"","max-length":20,"show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"]),u(l,{field:"icCard",label:"IC\u5361\u53F7",rules:[{match:m(g).normal,message:"IC\u5361\u53F7\u4E0D\u80FD\u6709\u7279\u6B8A\u5B57\u7B26"}]},{default:s(()=>[u(d,{modelValue:a.icCard,"onUpdate:modelValue":e[7]||(e[7]=t=>a.icCard=t),placeholder:"\u8BF7\u8F93\u5165IC\u5361\u53F7",autocomplete:"off","allow-clear":"","max-length":25,"show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"]),u(l,{field:"familyAddress",label:"\u5BB6\u5EAD\u4F4F\u5740"},{default:s(()=>[u(Y,{modelValue:a.familyAddress,"onUpdate:modelValue":e[8]||(e[8]=t=>a.familyAddress=t),placeholder:"\u8BF7\u8F93\u5165\u8BE6\u7EC6\u7684\u5BB6\u5EAD\u4F4F\u5740\uFF0C\u6700\u591A\u4E0D\u8D85\u8FC7100\u5B57\u3002","allow-clear":"","auto-size":{maxRows:4,minRows:3},"max-length":100,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),u(c,{span:12},{default:s(()=>[u(l,{field:"identityCard",label:"\u8EAB\u4EFD\u8BC1\u53F7",rules:[{match:m(g).idCard,message:"\u8EAB\u4EFD\u8BC1\u53F7\u683C\u5F0F\u9519\u8BEF"}]},{default:s(()=>[u(d,{modelValue:a.identityCard,"onUpdate:modelValue":e[9]||(e[9]=t=>a.identityCard=t),placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u53F7",autocomplete:"off","allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),u(l,{field:"status",label:"\u5728\u6821\u72B6\u6001"},{default:s(()=>[u(D,{modelValue:a.status,"onUpdate:modelValue":e[10]||(e[10]=t=>a.status=t),placeholder:"\u8BF7\u9009\u62E9\u5728\u6821\u72B6\u6001",options:q,"allow-clear":""},null,8,["modelValue"])]),_:1}),u(l,{field:"emergencyContactPhone",label:"\u7D27\u6025\u8054\u7CFB\u4EBA\u53F7\u7801",rules:[{required:!1,match:m(g).phone,message:"\u7D27\u6025\u8054\u7CFB\u4EBA\u53F7\u7801\u683C\u5F0F\u9519\u8BEF"}]},{default:s(()=>[u(d,{modelValue:a.emergencyContactPhone,"onUpdate:modelValue":e[11]||(e[11]=t=>a.emergencyContactPhone=t),placeholder:"\u8BF7\u8F93\u5165\u7D27\u6025\u8054\u7CFB\u4EBA\u53F7\u7801",autocomplete:"off","allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1})])])]),_:1},8,["model"])]),p("div",Oe,[u(y,{class:"mr8",type:"primary",loading:m(I),onClick:Q},{default:s(()=>[je]),_:1},8,["loading"]),u(y,{class:"mr8",onClick:K},{default:s(()=>[ze]),_:1}),u(y,{onClick:W},{default:s(()=>[$e]),_:1})])])}}});const _a=ae(Je,[["__scopeId","data-v-a9daee1f"]]);export{_a as default};
